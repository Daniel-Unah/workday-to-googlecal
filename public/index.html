<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScheduleSync</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2RSM9P5ZLQ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2RSM9P5ZLQ');
    </script>
</head>
<body>
    <div class="container">
        <h1>ScheduleSync</h1>
        <p class="subtitle">Upload your schedule from Workday to Google Calendar in seconds</p>

        <!-- Step 1: Get Your Schedule -->
        <div class="card">
            <h2><span class="step-number">1</span>Get Your Schedule</h2>
            
            <div class="manual-section">
                <h3>Spreadsheet Download</h3>
                <p><strong>How to get your schedule from Workday manually:</strong></p>
                <ol>
                    <li>Log into your Workday account</li>
                    <li>Navigate to your course schedule or academic calendar</li>
                    <li>Look for the "Export to Excel" button</li>
                    <li>Click download when prompted</li>
                </ol>
                
                <div style="margin: 20px 0; text-align: center;">
                    <img src="export_to_excel.jpg" alt="Workday Export Button Location" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);" />
                    <p style="margin-top: 10px; font-style: italic; color: #666;">Look for the Export button in your Workday schedule view</p>
                </div>
                
                <p><strong>Note:</strong> The Excel file should contain columns like Course Name, Days, Time, Location, etc.</p>
            </div>
        </div>

        <!-- Step 2: File Upload -->
        <div class="card">
            <h2><span class="step-number">2</span>Upload Your Schedule</h2>
            <div class="file-input-wrapper">
                <input type="file" id="fileInput" accept=".xlsx" class="file-input" />
            </div>
            <div id="errorMessage" class="error hidden"></div>
            <div id="successMessage" class="success hidden"></div>
            <div id="preview"></div>
        </div>

        <!-- Step 3: Add to Calendar -->
        <div class="card">
            <h2><span class="step-number">3</span>Add to Your Calendar</h2>
            
            <!-- Google Calendar Integration -->
            <div class="google-calendar-section">
                <h3> Google Calendar (Recommended)</h3>
                <div id="googleAuthSection">
                    <p>Connect your Google Calendar to add courses directly:</p>
                    <button id="googleAuthBtn" class="btn btn-google">
                        <span class="btn-icon">ðŸ”—</span>
                        Connect Google Calendar
                    </button>
                    <p class="help-text">Authenticate with Google to add courses directly to your calendar</p>
                </div>
                
                <div id="googleCalendarSection" class="hidden">
                    <p>âœ… Connected to Google Calendar!</p>
                    <div id="googleErrorMessage" class="error hidden"></div>
                    <div id="googleSuccessMessage" class="success hidden"></div>
                    <div class="calendar-options">
                        <label for="calendarSelect">Choose calendar:</label>
                        <select id="calendarSelect" class="form-select">
                            <option value="primary">Primary Calendar</option>
                        </select>
                    </div>
                    <div class="calendar-actions">
                        <button id="addToGoogleBtn" class="btn btn-success" disabled>
                            Add All Courses to GCal
                        </button>
                        <button id="removeEventsBtn" class="btn btn-danger hidden" style="margin-left: 10px;">
                            Remove Added Events
                        </button>
                        <button id="disconnectGoogleBtn" class="btn btn-secondary">
                            Disconnect GCal
                        </button>
                    </div>
                </div>
            </div>

            <!-- Manual Download Options -->
            <div class="manual-download-section">
                <h3> Manual Download</h3>
                <div class="manual-actions">
                    <button id="downloadBtn" class="btn" disabled>Download ICS File</button>
                    <button id="resetBtn" class="btn btn-secondary" onclick="resetConverter()">Upload New File</button>
                </div>
                <p style="margin-top: 15px; color: #666;">
                    <strong>ICS File:</strong> Import the downloaded .ics file into Google Calendar, Outlook, Apple Calendar, or any calendar application.
                </p>
            </div>
        </div>

        <div class="footer">
            <p>Built for WashU students, by a WashU student</p>
            <p style="margin-top: 8px; font-size: 14px;">
                <a href="/privacy.html" style="margin-right: 12px;">Privacy Policy</a>
                <a href="/terms.html">Terms of Service</a>
            </p>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
